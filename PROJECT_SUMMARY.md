# 社团管理系统 - 项目总结

## 项目概述

社团管理系统是一个完整的Web应用，基于Spring Boot + Vue2技术栈开发，实现了社团成员管理、活动管理、部门管理、数据导出等核心功能。系统采用基于角色的权限控制，支持多种用户角色和细粒度权限管理。

## 技术架构

### 后端技术栈
- **框架**: Spring Boot 2.7.18
- **数据库**: MySQL 8.0
- **ORM**: MyBatis-Plus 3.5.3.1
- **认证**: JWT + Spring Security
- **文档处理**: Apache POI (Excel) + iText (PDF)
- **构建工具**: Maven
- **JDK版本**: JDK 21

### 前端技术栈
- **框架**: Vue 2 + Vue Router + Vuex
- **UI组件**: Element UI
- **HTTP客户端**: Axios
- **图表库**: ECharts
- **样式预处理**: Sass
- **构建工具**: Vue CLI 4

### 测试框架
- **UI自动化测试**: Playwright
- **浏览器支持**: Firefox, Chrome
- **测试报告**: HTML, JSON, JUnit

## 核心功能模块

### 1. 认证系统
- ✅ JWT token认证
- ✅ 多用户类型支持（系统管理员 + 社团成员）
- ✅ 基于角色的权限控制
- ✅ 登录状态保持

### 2. 仪表板
- ✅ 统计数据展示（成员总数、活动数量、待审批等）
- ✅ 图表可视化（部门分布、活动类型统计）
- ✅ 权限相关数据过滤
- ✅ 待审批活动列表
- ✅ 角色权限控制（干事只显示相关卡片）

### 3. 成员管理
- ✅ 成员信息CRUD操作
- ✅ 分页查询和搜索
- ✅ 批量导入导出
- ✅ 基于角色的权限控制
- ✅ 数据隔离（干事只能查看自己，部长只能查看本部门）

### 4. 部门管理
- ✅ 部门信息管理
- ✅ 部门成员统计
- ✅ 部门详情展示
- ✅ 权限控制

### 5. 活动管理
- ✅ 活动创建和编辑
- ✅ 多签审批流程
- ✅ 活动参与管理
- ✅ 活动报名功能
- ✅ 审批状态跟踪
- ✅ 审批通知系统
- ✅ 权限控制（干事不能创建活动）

### 6. 消息系统
- ❌ 未读消息提醒（已移除）
- ❌ 消息列表查看（已移除）
- ❌ 消息标记已读（已移除）
- ❌ 消息删除功能（已移除）

### 7. 数据导出
- ✅ Excel格式导出
- ✅ PDF格式导出
- ✅ 导出历史管理
- ✅ 文件下载功能

### 8. 个人中心
- ✅ 个人信息编辑
- ✅ 密码修改
- ✅ 个人活动查看
- ❌ 头像上传功能（已移除）

### 9. 响应式设计
- ✅ 桌面端适配
- ✅ 平板端适配
- ✅ 手机端适配
- ✅ 移动端优化

### 10. 文件上传
- ✅ 本地文件存储
- ✅ 文件类型验证
- ✅ 文件大小限制
- ✅ 静态资源访问

## 权限控制体系

### 角色定义
- **社长**: 全权限，可以管理所有功能
- **副社长**: 大部分权限，可以审批活动和管理成员
- **部长**: 部门级权限，只能管理本部门成员
- **副部长**: 查看权限，可以查看本部门数据
- **干事**: 个人权限，只能查看和编辑自己的信息
- **指导老师**: 审批权限，可以审批活动

### 权限实现
- 前端路由权限控制
- 后端API权限验证
- 数据隔离和过滤
- 操作按钮权限控制

## 数据库设计

### 核心表结构
- `sys_user`: 系统用户表
- `member`: 社团成员表
- `dept`: 部门表
- `activity`: 活动表
- `activity_member`: 活动参与记录表
- `activity_approver`: 活动审批人表
- `activity_dept`: 活动部门关联表
- `sys_message`: 系统消息表
- `sys_log`: 系统日志表

### 数据关系
- 成员与部门：多对一关系
- 活动与成员：多对多关系
- 活动与审批人：多对多关系
- 活动与部门：多对多关系

## 测试覆盖

### UI自动化测试
- ✅ 登录功能测试
- ✅ 仪表板功能测试
- ✅ 成员管理功能测试
- ✅ 部门管理功能测试
- ✅ 活动管理功能测试
- ✅ 文件上传功能测试
- ✅ 导出功能测试
- ✅ 统计模块测试
- ✅ 权限控制测试
- ✅ 响应式设计测试

### 测试工具
- Playwright自动化测试框架
- 支持Firefox和Chrome浏览器
- 生成HTML测试报告
- 失败测试自动截图和视频录制

## 部署配置

### 后端配置
- 端口: 8081
- 上下文路径: /api
- 数据库: MySQL 8.0
- JWT密钥: 可配置
- 文件上传路径: ./uploads

### 前端配置
- 端口: 5174
- API代理: /api -> http://localhost:8081
- 支持跨域请求
- 静态资源优化

## 项目文件结构

### 后端结构
```
backend/
├── src/main/java/com/club/management/
│   ├── ClubManagementApplication.java
│   ├── common/ (通用类)
│   ├── config/ (配置类)
│   ├── controller/ (控制器)
│   ├── entity/ (实体类)
│   ├── mapper/ (数据访问层)
│   ├── service/ (业务逻辑层)
│   └── dto/ (数据传输对象)
├── src/main/resources/
│   ├── application.yml
│   ├── mapper/ (MyBatis映射文件)
│   └── sql/ (数据库脚本)
└── pom.xml
```

### 前端结构
```
frontend/
├── src/
│   ├── components/ (通用组件)
│   ├── views/ (页面组件)
│   ├── router/ (路由配置)
│   ├── store/ (状态管理)
│   ├── utils/ (工具函数)
│   └── styles/ (样式文件)
├── tests/ (测试文件)
├── public/ (静态资源)
└── package.json
```

## 开发历程

### 主要里程碑
1. **项目初始化**: 搭建Spring Boot + Vue2基础架构
2. **数据库设计**: 根据SDS.md设计数据库表结构
3. **认证系统**: 实现JWT认证和权限控制
4. **核心功能**: 完成成员、部门、活动管理功能
5. **高级功能**: 实现多签审批、数据导出、消息系统
6. **UI优化**: 响应式设计和用户体验优化
7. **测试完善**: 全面的UI自动化测试覆盖
8. **问题修复**: 解决各种技术问题和兼容性问题

### 解决的关键问题
- 数据库Schema与设计文档不一致
- 统一用户认证系统实现
- 权限控制系统完善
- 多签审批流程实现
- 文件上传功能实现
- 统计模块实现
- PDF导出功能实现
- UI自动化测试完整实现

## 测试账号

### 系统管理员
- 学号: admin, 密码: password, 角色: 社长

### 社团成员
- 学号: 2021001, 密码: password, 角色: 社长
- 学号: 2021002, 密码: password, 角色: 副社长
- 学号: 2021003, 密码: password, 角色: 部长
- 学号: 2021004, 密码: password, 角色: 副部长
- 学号: 2021005, 密码: password, 角色: 干事
- 学号: 2021006, 密码: password, 角色: 指导老师

## 快速启动

### 后端启动
```bash
cd backend
mvn clean package -DskipTests
java -jar target/club-management-1.0.0.jar
```

### 前端启动
```bash
cd frontend
npm install
npm run serve
```

### 访问地址
- 前端: http://localhost:5174
- 后端API: http://localhost:8081/api

## 项目特色

1. **完整的权限控制**: 基于角色的细粒度权限管理
2. **多签审批流程**: 支持复杂的活动审批流程
3. **响应式设计**: 支持多设备访问
4. **数据可视化**: 集成ECharts图表展示
5. **文件管理**: 支持文件上传和导出
6. **消息系统**: 完整的消息通知机制
7. **自动化测试**: 全面的UI自动化测试覆盖
8. **文档完善**: 详细的问题记录和解决方案

## 技术亮点

1. **统一认证**: 支持系统管理员和社团成员两种用户类型
2. **数据隔离**: 不同角色看到不同的数据范围
3. **多签审批**: 实现复杂的多签审批流程
4. **文件处理**: 支持Excel和PDF格式的数据导出
5. **实时统计**: 动态计算和展示各种统计数据
6. **移动适配**: 完整的响应式设计支持
7. **测试驱动**: 全面的自动化测试保证质量

## 后续优化建议

1. **性能优化**: 数据库查询优化、缓存机制
2. **安全增强**: 更严格的输入验证、SQL注入防护
3. **功能扩展**: 更多统计图表、批量操作功能
4. **用户体验**: 更丰富的交互效果、操作提示
5. **部署优化**: Docker容器化、CI/CD流水线
6. **监控告警**: 系统监控、错误日志收集

## 总结

本项目是一个功能完整、技术先进的社团管理系统，实现了从需求分析到系统部署的完整开发流程。系统具有良好的可扩展性和可维护性，代码结构清晰，文档完善，测试覆盖全面。通过本项目的开发，展示了现代Web应用开发的最佳实践，包括前后端分离架构、权限控制、数据可视化、自动化测试等技术要点。

## 最新更新 (2025-10-21)

### 功能优化
- ✅ 修复了数据导出功能的500错误问题
- ✅ 修复了个人信息保存的400错误问题  
- ✅ 完善了批量导入社员模板，添加了示例数据和详细说明
- ✅ 删除了活动创建表单中的"负责人"字段
- ✅ 修复了活动审批人搜索功能，支持搜索Member表和SysUser表
- ✅ 修复了指导老师报名权限问题，确保符合SDS.md规范
- ✅ 完善了所有角色的权限控制和功能测试
- ✅ 修复了社员管理部门字段显示问题，正确显示部门名称
- ✅ 优化了活动管理搜索功能，删除了日期搜索字段
- ✅ 将活动列表中的"创建人"列改为"负责部门"列
- ✅ 完全移除了头像相关功能，简化系统界面
- ✅ 实现了活动报名功能，支持干事等角色报名参加活动
- ✅ 根据角色控制仪表盘卡片显示，干事只显示相关卡片
- ✅ 根据角色控制活动管理页面功能，干事不能创建活动
- ✅ 完全删除了消息中心功能，简化系统界面
- ✅ 优化了部门详情页面，年级字段改为下拉框选择
- ✅ 修复了密码验证功能，确保密码修改正常工作
- ✅ 优化了数据导出下载功能，支持文件下载
- ✅ 修复了进度条百分比验证错误
- ✅ 修复了登录500错误问题，彻底解决了数据库字段映射冲突
- ✅ 优化了数据库Schema与实体类映射，提高了系统稳定性
- ✅ 修复了活动编辑页面必填项标注和400错误问题
- ✅ 完善了活动详情页面参与人员管理功能
- ✅ 修复了活动报名时间显示问题
- ✅ 修复了活动审批状态更新问题
- ✅ 统一了活动时间格式显示（只显示年月日）
- ✅ 修复了活动更新时间实时更新问题
- ✅ 实现了活动报名取消功能
- ✅ 完善了个人中心必填项标注
- ✅ 完善了批量导入说明文档
- ✅ 优化了仪表盘用户参与活动显示
- ✅ 修复了活动详情页面loadMembers方法缺失问题
- ✅ 修复了活动编辑页面数据加载问题
- ✅ 优化了活动时间格式显示（创建时间只显示日期，更新时间显示日期和时分）
- ✅ 优化了审批弹窗高度，提升用户体验
- ✅ 修复了仪表盘数据一致性问题
- ✅ 优化了社员管理批量导入弹窗显示
- ✅ 修复了活动管理审批状态实时更新问题
- ✅ 修复了活动详情页面参与人员数据实时更新问题
- ✅ 修复了活动报名字段显示问题
- ✅ 优化了活动编辑页面审批人显示格式
- ✅ 优化了活动更新时间格式和实时更新机制
- ✅ 实现了多人审批状态显示功能
- ✅ 最终修复了仪表盘数据一致性问题
- ✅ 修复了仪表盘待审批活动数据显示问题
- ✅ 优化了社员管理批量导入弹窗内容显示
- ✅ 实现了活动管理页面多人审批状态显示
- ✅ 彻底修复了活动详情页面参与人员表单空白问题
- ✅ 彻底修复了活动报名字段显示问题
- ✅ 修复了活动编辑页面已有审批人显示格式
- ✅ 实现了多人审批状态显示功能
- ✅ 彻底修复了仪表盘数据一致性问题
- ✅ 彻底修复了仪表盘待审批活动数据显示问题
- ✅ 彻底修复了社员管理批量导入弹窗内容显示
- ✅ 实现了活动管理页面多人审批状态显示功能
- ✅ 彻底修复了活动参与人员管理功能（移除时表单变空白、报名时字段显示undefined、取消报名状态不持久）
- ✅ 修复了活动参与人员管理弹窗添加成员问题（添加新成员时原有成员消失）
- ✅ 完善了后端API数据持久化机制，确保参与人员数据正确保存和删除
- ✅ 优化了前端字段映射，修复了memberId字段访问错误
- ✅ 实现了完整的参与人员管理功能，支持添加、移除、报名、取消报名
- ⚠️ 个人中心密码修改问题暂未解决（需要进一步排查环境配置）
- ⚠️ 数据导出下载功能问题暂未解决（需要重启后端服务或检查环境配置）

### 技术改进
- 优化了数据库查询，使用resultMap正确映射关联字段
- 简化了前端界面，移除了不必要的功能组件
- 改进了数据展示逻辑，提供更直观的信息展示
- 完善了错误处理和用户反馈机制
- 实现了完整的活动报名系统，包括报名状态管理
- 优化了权限控制系统，根据SDS.md要求完善权限矩阵
- 改进了数据库Schema与实体类映射，避免字段冲突
- 增强了密码验证功能，提供更好的调试信息
- 彻底解决了MyBatis-Plus字段映射冲突问题
- 优化了数据库表结构，删除了不再使用的字段
- 改进了实体类设计，使用@TableField注解标记非数据库字段
- 重构了活动参与人员管理API，实现真正的数据替换而非追加
- 优化了前端数据加载逻辑，确保参与人员数据完整性和实时性
- 完善了字段映射机制，修复了前后端数据字段不一致问题
- 实现了数据持久化的原子性操作，确保添加/删除成员操作的可靠性
