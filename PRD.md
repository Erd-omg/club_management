# 社团管理系统 - 需求规格说明书
## 1. 项目背景
解决高校社团日常管理痛点： 

+ 社员信息、活动记录、换届交接全靠 Excel，易丢失、难统计 
+ 活动审批无留痕，指导老师无法远程确认 
+ 无权限划分，数据安全隐患大 
+ 活动参与人员管理混乱，数据不一致
+ 缺乏实时数据统计和可视化展示

**目标**：交付一套"校内网可用、社长可维护、一页就能看懂"的轻量级社团管理系统，实现社团管理的数字化、规范化和智能化。

---

## 2. 范围
+ PC 网页版，仅支持单社团 
+ 角色：社长、副社长、部长、副部长、干事、指导老师 
+ 核心功能：社员档案、活动审批、参与记录、导出交接包 

---

## 3. 角色与权限
| 角色 | 权限摘要 |
| :--- | :--- |
| 社长 | 全权限，含后台账号管理 |
| 副社长 | 同社长，仅不含“账号管理” |
| 部长 | 可编辑本部门成员 + 创建/编辑本部门负责的活动 |
| 副部长 | 只读本部门成员，可导出数据 |
| 干事 | 仅查看和编辑自己档案、查看已发布活动 |
| 指导老师 | 可审批活动（通过/驳回），其余同副社长 |


| 角色 | 查看全员档案 | 编辑档案 | 查看全部活动 | 创建/编辑活动 | 审批活动 | 导出数据 | 后台管理 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 社长 | ✔ | ✔ | ✔ | ✔ | ✔ | ✔ | ✔ |
| 副社长 | ✔ | ✔ | ✔ | ✔ | ✔ | ✔ | ✔ |
| 部长 | ✔（本部门可编辑） | 仅本部门 | ✔ | ✔（本部门为负责方） | ❌ | ✔ | ❌ |
| 副部长 | ✔ | ❌ | ✔ | ❌ | ❌ | ✔ | ❌ |
| 干事 | 仅自己 | 仅自己 | ✔ | ❌ | ❌ | ❌ | ❌ |
| 指导老师 | ✔ | ✔ | ✔ | ✔ | ✔ | ✔ | ❌ |


**账号来源**：社长在后管“账号管理”页统一新增，初始密码=学号后 6 位，不强制修改。

---

## 4. 功能需求
### 4.1 登录
+ URL：`/login`
+ 字段：学/工号、密码
+ 成功返回 JWT（有效期 24h），失败 5 次锁定 30 分钟

### 4.2 社员档案
#### 4.2.1 单条维护
+ 字段：姓名、性别、学号、学院、专业、年级、手机、邮箱、入社时间、部门、角色
+ 学号全局唯一；重复给出 toast 提示

#### 4.2.2 批量导入
+ 入口：【社员管理→导入】
+ 提供“下载模板”按钮，列顺序固定（同字段顺序）
+ 每次最多 500 行；导入预览页展示异常行，确认后正式写入
+ 异常处理：空学号/重复学号/非法日期 标红并阻止导入

#### 4.2.3 列表与查询
+ 默认 10 条/页，可切 20/50
+ 支持按“姓名、学号、部门、角色”组合筛选
+ 点击行进入详情页，展示基本信息 + 参与活动列表（时间倒序）

### 4.3 部门管理
+ 初始化 SQL 插入 4 部门：宣传部、技术部、培训服务部、办公室
+ 社长可在【后台管理→部门设置】增删改名称，删除前校验无成员关联

### 4.4 活动管理
#### 4.4.1 创建/编辑
+ 字段：活动名称、开始时间、结束时间、地点、类型（下拉：例会/比赛/志愿/外出）、负责人（下拉成员）、参与人员（多选）、签到方式（文本 30 字）、活动简介（富文本≤2000 字）
+ 保存后状态=“待审批”，指导老师审批前仅创建者可编辑

#### 4.4.2 审批流
+ 指导老师登录后顶部导航出现【活动审批】红点数
+ 列表页展示待审批活动，操作列：通过/驳回
+ 驳回必须填写理由（≤200 字），系统发站内信给创建者

#### 4.4.3 活动列表
+ 筛选项：名称、类型、时间段、负责人、状态（全部/待审批/已通过/已驳回）
+ 已通过活动对所有角色可见；其余仅创建者+社长/副社长/老师可见

#### 4.4.4 参与记录维护
+ 活动详情页展示“参与人”面板，部长及以上可勾选/取消，即时保存
+ 无迟到/早退状态

### 4.5 统计
+ 社员维度：总参与次数、最近活跃时间（最新一次活动结束时间）
+ 活动维度：参与人数、出勤率（=参与人数/应到人数，应到=当时社团总人数）
+ 仅部长及以上可见

### 4.6 导出交接包
+ 入口：【后台管理→换届交接】
+ 一键生成 zip，文件名=`社团档案_{yyyyMMdd_HHmmss}.zip`
+ 含：
    - `社员档案.xlsx`（全字段）
    - `活动记录.xlsx`（字段：名称、时间、地点、类型、负责人、参与人名单）
    - `活动记录.pdf`（带页眉“XX 社团活动汇总”、页脚“生成时间 + 第 X 页/共 Y 页”、落款“XX 社团 + 日期”）
+ 下载链接 1 小时内有效，OSS 直链不暴露真实路径

---

## 5. 非功能需求
| 类别 | 要求 |
| :--- | :--- |
| 性能 | 单表 1 万条数据，列表查询 ≤800 ms |
| 安全 | 密码 bcyrpt(10) 存储；JWT 秘钥 256-bit 随机；OSS 使用 RAM 最小权限 |
| 兼容 | Chrome ≥90、Edge ≥90、Firefox ≥90 |
| 网络 | 仅校内局域网，HTTP 即可 |
| 备份 | 数据库每日凌晨 3 点 mysqldump，保留 7 天 |
| 日志 | 关键操作（登录、审批、导出、删成员）写表 `sys_log`，保留 180 天 |


---

## 6. 界面规则
+ 侧栏三级菜单深度以内，图标用 ElementUI 官方
+ 列表空数据统一用 `el-empty` 描述“暂无数据”
+ 所有删除操作需二次 confirm
+ Toast 持续时间 3s；成功绿色，失败红色
+ 分页参数保存在 URL query，刷新保持页码

---

## 7. 数据库概览（核心表）
```plain
member(id, stu_id, name, gender, college, major, grade, phone, email, join_date, dept_id, role,password, create_by, create_time, update_time)

dept(id, name, sort)

activity(id, name, start_time, end_time, location, type, leader_id, description, status【0待审/1通过/2驳回】, reject_reason, create_by, create_time, update_time)

activity_member(id, activity_id, member_id, create_time)

sys_user(id, stu_id, name, role, password, status, create_time)  ← 保留超管账号，与 member 分离，便于以后多社团

sys_log(id, operator, operation, method, params, ip, create_time)
```

外键均逻辑外键，便于批量删除。 

索引：member.stu_id 唯一；activity.start_time；activity_member.activity_id+member_id 联合唯一。

---

## 8. 接口命名规范
`/{模块}/{子模块}/{动作}`

GET 查询 / POST 新增 / PUT 全量更新 / PATCH 部分更新 / DELETE 删除 

例： 

`GET /member/page`

`POST /member/import`

`PUT /activity/approve/{id}`

`GET /export/transition` → 返回 zip 下载 URL

---

## 9. 错误码
| 代码 | 含义 |
| :--- | :--- |
| 200 | 成功 |
| 4001 | 学号已存在 |
| 4002 | 活动已审批通过，不可修改 |
| 4003 | 部门下仍有成员 |
| 401 | 未登录或 token 过期 |
| 403 | 权限不足 |
| 500 | 系统异常 |


---

## 10. 技术栈
后端：SpringBoot 2.7 + MyBatisPlus + Swagger3 + JWT

前端：Vue2 + VueRouter + Vuex + ElementUI + vue-admin-template

工具：IDEA + VSCode + Maven + npm

部署：学校内网


---

## 11. 界面交互规范

### 11.1 列表页面设计
- **搜索筛选**：置于页面顶部，支持多条件组合查询
- **新增操作**：右上角"新增"按钮，复杂表单跳转独立页面
- **空数据状态**：统一使用 `el-empty` 组件
- **删除操作**：二次确认对话框
- **分页参数**：保存在URL query中，刷新保持状态

### 11.2 仪表盘设计（按角色展示）
- **管理员角色**：显示完整统计卡片、图表、待审批列表
- **干事角色**：仅显示"我参与的活动"和"可参与活动"
- **其他角色**：根据权限显示相应功能模块

### 11.3 个人中心设计
- **可编辑字段**：姓名、邮箱、手机号
- **只读字段**：部门、角色
- **数据验证**：前端校验 + 后端验证
- **状态更新**：保存成功后自动刷新用户信息

### 11.4 通用交互规范
- **Toast提示**：成功绿色，失败红色，持续3秒
- **加载状态**：操作按钮显示loading状态
- **错误处理**：统一的错误提示和重试机制
- **权限控制**：按钮和菜单根据角色动态显示/隐藏

